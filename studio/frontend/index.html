<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>CrowdListen Studio</title>
  <link rel="stylesheet" href="style.css"/>
</head>
<body>
<div id="app">

  <!-- Header -->
  <header id="header">
    <span class="logo" onclick="gotoStep(1)" style="cursor:pointer">CrowdListen <span class="logo-accent">Studio</span></span>
    <div class="header-right">
      <button class="nav-link" data-tab="create" onclick="switchTab('create')">Create</button>
      <button class="nav-link" data-tab="published" onclick="switchTab('published')">Published</button>
    </div>
  </header>

  <div id="main">

    <!-- â”€â”€ CREATE TAB â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <div id="tab-create" class="tab-page active">

      <!-- Progress bar -->
      <div id="step-bar" class="step-bar">
        <div class="step-item active" data-step="1" onclick="gotoStep(1)">
          <span class="step-num">1</span><span class="step-label">Upload</span>
        </div>
        <div class="step-divider"></div>
        <div class="step-item" data-step="2">
          <span class="step-num">2</span><span class="step-label">Options</span>
        </div>
        <div class="step-divider"></div>
        <div class="step-item" data-step="3">
          <span class="step-num">3</span><span class="step-label">Process</span>
        </div>
        <div class="step-divider"></div>
        <div class="step-item" data-step="4">
          <span class="step-num">4</span><span class="step-label">Library</span>
        </div>
      </div>

      <!-- STEP 1: Upload -->
      <div id="step-1" class="step-page">
        <div class="step-hero">
          <h1>Upload a video</h1>
          <p>Drop any source video â€” we'll extract the best clip moments automatically.</p>
        </div>
        <div id="drop-zone" class="drop-zone"
             onclick="document.getElementById('file-input').click()"
             ondragover="handleDragOver(event)"
             ondragleave="handleDragLeave(event)"
             ondrop="handleDrop(event)">
          <div class="drop-icon">ğŸ¬</div>
          <div class="drop-label">Drop video here or <span class="drop-link">click to browse</span></div>
          <div class="drop-hint">MP4, MOV, AVI, MKV Â· up to 2GB</div>
          <input id="file-input" type="file" accept=".mp4,.mov,.avi,.mkv" style="display:none" onchange="handleFileSelect(event)"/>
        </div>
        <div id="upload-progress" class="upload-progress hidden">
          <div class="progress-label" id="upload-label">Uploadingâ€¦</div>
          <div class="progress-bar"><div class="progress-fill" id="upload-fill" style="width:0%"></div></div>
        </div>
      </div>

      <!-- STEP 2: Options -->
      <div id="step-2" class="step-page hidden">
        <div class="step-hero">
          <h1>What kind of clips?</h1>
          <p>Choose your formats and processing options.</p>
        </div>

        <div class="options-grid">

          <!-- Clip Types -->
          <div class="option-section">
            <div class="option-section-title">Clip Type</div>
            <div class="type-cards">
              <label class="type-card selected" id="type-meme">
                <input type="checkbox" name="clip_type" value="meme" checked hidden/>
                <span class="type-icon">ğŸ­</span>
                <span class="type-name">Meme Clips</span>
                <span class="type-desc">Funny/relatable moments Â· punchy 2-line caption Â· 10â€“30s</span>
              </label>
              <label class="type-card" id="type-quote">
                <input type="checkbox" name="clip_type" value="quote" hidden/>
                <span class="type-icon">ğŸ—£ï¸</span>
                <span class="type-name">Speaker Quotes</span>
                <span class="type-desc">Quotable insights Â· clean text overlay Â· 10â€“45s</span>
              </label>
            </div>
          </div>

          <!-- Add-ons -->
          <div class="option-section">
            <div class="option-section-title">Add-ons</div>
            <label class="toggle-row">
              <input type="checkbox" id="opt-narration"/>
              <span class="toggle-track"><span class="toggle-thumb"></span></span>
              <span class="toggle-label">ğŸ™ï¸ Narrated CTA â€” append TTS voiceover + CrowdListen branding</span>
            </label>
          </div>

          <!-- Count + Audience -->
          <div class="option-section two-col">
            <div>
              <div class="option-section-title">Clip count</div>
              <div class="count-row">
                <input type="range" id="opt-count" min="5" max="20" value="10" oninput="document.getElementById('count-val').textContent=this.value"/>
                <span id="count-val" class="count-val">10</span>
              </div>
            </div>
            <div>
              <div class="option-section-title">Target audience</div>
              <input type="text" id="opt-audience" class="text-input"
                     value="engineers, PMs, and the broader AI community"
                     placeholder="e.g. engineers, PMs, founders"/>
            </div>
          </div>

          <!-- Ad Placement -->
          <div class="option-section">
            <div class="option-section-title">Ad Placement</div>
            <label class="toggle-row" style="margin-bottom:12px">
              <input type="checkbox" id="opt-ads" onchange="toggleAdOptions(this.checked)"/>
              <span class="toggle-track"><span class="toggle-thumb"></span></span>
              <span class="toggle-label">Enable ad insertion</span>
            </label>
            <div id="ad-options" class="ad-options hidden">
              <div class="ad-row">
                <label class="ad-label">Ad asset</label>
                <div class="ad-asset-row">
                  <select id="ad-asset-select" class="select-input">
                    <option value="">â€” upload or select â€”</option>
                  </select>
                  <button class="btn-small" onclick="document.getElementById('ad-file-input').click()">Upload</button>
                  <input id="ad-file-input" type="file" accept=".mp4,.mov,.jpg,.jpeg,.png,.webp" style="display:none" onchange="uploadAdAsset(event)"/>
                </div>
              </div>
              <div class="ad-row">
                <label class="ad-label">Placement</label>
                <select id="ad-placement" class="select-input" onchange="toggleAdFrequency(this.value)">
                  <option value="end">End only</option>
                  <option value="between">Between clips</option>
                  <option value="both">Both</option>
                </select>
              </div>
              <div class="ad-row" id="ad-frequency-row" style="display:none">
                <label class="ad-label">Frequency</label>
                <div class="count-row">
                  <input type="range" id="ad-frequency" min="1" max="5" value="2"
                         oninput="document.getElementById('freq-val').textContent='Every '+this.value+' clips'"/>
                  <span id="freq-val" class="count-val">Every 2 clips</span>
                </div>
              </div>
              <div class="ad-row">
                <label class="ad-label">Image duration (s)</label>
                <input type="number" id="ad-img-duration" class="text-input" value="5" min="3" max="30" style="width:80px"/>
              </div>
            </div>
          </div>

        </div>

        <div class="step-actions">
          <button class="btn-secondary" onclick="gotoStep(1)">â† Back</button>
          <button class="btn-primary" onclick="startPipeline()">Process Video â†’</button>
        </div>
      </div>

      <!-- STEP 3: Processing -->
      <div id="step-3" class="step-page hidden">
        <div class="step-hero">
          <h1>Processing your video</h1>
          <p id="processing-filename" class="processing-filename"></p>
        </div>
        <div class="pipeline-steps">
          <div class="pipeline-step" id="ps-audio">
            <span class="ps-icon">ğŸµ</span>
            <span class="ps-label">Extract audio</span>
            <span class="ps-status" id="pss-audio">â³</span>
          </div>
          <div class="pipeline-step" id="ps-transcribe">
            <span class="ps-icon">ğŸ“</span>
            <span class="ps-label">Transcribe (Whisper)</span>
            <span class="ps-status" id="pss-transcribe">â€“</span>
          </div>
          <div class="pipeline-step" id="ps-detect">
            <span class="ps-icon">ğŸ”</span>
            <span class="ps-label">Detect clip candidates</span>
            <span class="ps-status" id="pss-detect">â€“</span>
          </div>
          <div class="pipeline-step" id="ps-render">
            <span class="ps-icon">ğŸ¬</span>
            <span class="ps-label">Render clips</span>
            <span class="ps-status" id="pss-render">â€“</span>
          </div>
        </div>
        <div class="pipeline-progress">
          <div class="progress-bar"><div class="progress-fill" id="pipeline-fill" style="width:0%"></div></div>
          <p id="pipeline-msg" class="pipeline-msg">Startingâ€¦</p>
        </div>
      </div>

      <!-- STEP 4: Library -->
      <div id="step-4" class="step-page hidden">
        <div class="library-header">
          <h1>Select clips to publish</h1>
          <div class="library-actions">
            <span id="selected-count" class="selected-count">0 selected</span>
            <button class="btn-primary" id="save-btn" onclick="saveSelected()" disabled>Save Selected â†’</button>
          </div>
        </div>
        <div id="library-grid" class="library-grid">
          <div class="loading-state">Loading clipsâ€¦</div>
        </div>
      </div>

    </div><!-- /tab-create -->

    <!-- â”€â”€ PUBLISHED TAB â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <div id="tab-published" class="tab-page hidden">
      <div class="pub-header">
        <h1>Published</h1>
        <button class="btn-small" onclick="loadPublished()">Refresh</button>
      </div>
      <div id="published-grid" class="library-grid">
        <div class="loading-state">Loadingâ€¦</div>
      </div>
    </div>

  </div><!-- /main -->
</div><!-- /app -->

<script src="app.js"></script>
</body>
</html>
